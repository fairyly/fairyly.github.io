<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>海报首页</title>
    <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-title" content="海报首页">
    
    <link rel="stylesheet" type="text/css" href="css/addswiper.css">
    <script src="js/jquery-2.2.3.min.js"></script>
   <script type="text/javascript">
        var docEl = document.documentElement,
            //总来的来就是监听当然窗口的变化，一旦有变化就需要重新设置根字体的值
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function() {
                //设置根字体大小
                docEl.style.fontSize = 10 * (docEl.clientWidth / 320) + 'px';
            };
        //绑定浏览器缩放与加载时间
        window.addEventListener(resizeEvt, recalc, false);
        document.addEventListener('DOMContentLoaded', recalc, false);
    </script>
    <script type="text/javascript">
    //图片等比例缩小处理
    function AutoResizeImage(maxWidth,maxHeight,objImg){
            var img = new Image();
            img.src = objImg.src;
            var hRatio;
            var wRatio;
            var Ratio = 1;
            var w = img.width;
            var h = img.height;
            wRatio = maxWidth / w;
            hRatio = maxHeight / h;
            if (maxWidth ==0 && maxHeight==0){
                Ratio = 1;
                }
                else if (maxWidth==0){//
                    if (hRatio<1) Ratio = hRatio;
                       }else if (maxHeight==0){
                             if (wRatio<1) Ratio = wRatio;
                             }else if (wRatio<1 || hRatio<1){
                                   Ratio = (wRatio<=hRatio?wRatio:hRatio);
                                    }
            if (Ratio<1){
                w = w * Ratio;
                h = h * Ratio;
                }
            objImg.height = h;
            objImg.width = w;
    }
    </script>
</head>
<body>
 <!--  <article>
      <div class="start">
        <img src="images/start.jpg" >
        <div class="st">
            <div class="st1"><p>微商</p></div>
            <div class="st2">是一种态度</div>
            <div class="st3">
                <div class="st33"><input type="button" class="st333" value="启程"></div></div> 
            </div>
        </div>
      </div>
  </article> -->
  <!-- 启动页结束 -->
      <div class="first">
        <div class="header">
            <nav>
                <div class="nav">
                    <ul>
                        <li style="width:28%"><a href="index.html">返回</a></li>
                        <li style="width:45%"><a href="">微商海报</a></li>
                        <li style="width:22%"><a href="index.html">首页</a></li>
                    </ul>
                </div>
            </nav>
        </div>
        <!-- Swiper
        <!-- <div class="swiper-container">
            <div class="swiper-wrapper" style="left:12% ">
                <div class="swiper-slide"><img src="images/11.jpg"></div>
                <div class="swiper-slide"><img src="images/22.jpg"/></div>
                <div class="swiper-slide"><img src="images/33.jpg"/></div>
                <div class="swiper-slide"><img src="images/11.jpg"/></div>
                <div class="swiper-slide"><img src="images/22.jpg"/></div>
                <div class="swiper-slide"><img src="images/33.jpg"/></div>
                <div class="swiper-slide"><img src="images/11.jpg"/></div>
                <div class="swiper-slide"><img src="images/22.jpg"/></div>
                <div class="swiper-slide"><img src="images/33.jpg"/></div>
                <div class="swiper-slide"><img src="images/11.jpg"/></div>
            </div>
            <!-- Add Pagination
            <div class="swiper-pagination"></div>
        </div>
        <div class="more"><div><h2>更多海报模板</h2></div></div>--> 
      </div> 
    <!-- Swiper JS -->
    <!-- // <script src="js/swiper.min.js"></script> -->
    <!-- Initialize Swiper -->
    <script>
        // var swiper = new Swiper('.swiper-container', {
        //     pagination: '.swiper-pagination',
        //     // effect : 'coverflow',
        //     // slidesPerView: 3,
        //     // centeredSlides: true,
        //     paginationClickable: true
        // });
    </script>
    <!-- 首页结束 -->
    <div class="edit1">
        <div class="img1">
            <div class="m1" id="m1">
              <!-- onload="AutoResizeImage(500,480,this)"按照比例显示 -->
                <img src="images/m1.jpg" style="width:100%;max-width:640px" id="img1"/>
            </div>
            <div class="up1">
                <div class="up11">
                    <div class="fileInput left">
                          <input type="file" capture="camera" name="upfile" id="upfile" style="display:none" class="upfile" onchange="document.getElementById('upfileResult').innerHTML=this.value;"/>
                          <input class="upFileBtn" id="upfileResult" type="button" value="上传图片" onclick="document.getElementById('upfile').click();" />
                    </div>
                    <!-- <img src="images/upload.png" style="width:60px;height:60px;"> -->
                </div>
            </div>
        </div>
        <div class="bg1">
            <div class="titl" style="width:100%;margin: -40px auto;">
                <div class="title1">
                    <!-- contenteditable="true" -->
                    <p style="font-size:1.2rem;text-align:center;"><input class="input1" id="p1" type="text" maxlength="3" value="红领巾" style="border:0px;background:rgba(255,255,255,0);text-align:center;"/></p>
                    <h2 id="p2" contenteditable="true" style="width:100%;height:3rem;line-height:3rem;margin: 0px auto;overflow: hidden;font-size:2.5rem;font-weight:bold">红领巾联盟商店</h2>
                    <p id="p3" contenteditable="true" style="width:83%;overflow:hidden;margin:2px auto;font-size:0.5rem;border-top:1px solid #000;padding-top:2px;">HONGLINGJIN LIANMENG SHOP</p>
                </div>
            </div>  
            <div class="content1">
                <p id="p4" style="font-size:1rem;color:#fe86a0">微信</p>
                <p id="p5" contenteditable="true" style="width:100%;overflow:hidden;">517578123</p>
                <p id="p6" style="font-size:1rem;color:#fe86a0">QQ</p>
                <p id="p7" contenteditable="true" style="width:100%;overflow:hidden;">517578123</p>
                <p id="p8" style="font-size:1rem;color:#fe86a0">电话</p>
                <p id="p9" contenteditable="true" style="width:100%;overflow:hidden;">12517578123</p>
            </div>
            <div class="img11">
                <div class="m2" style="text-align:center">
                    <img src="images/m2.jpg" style="width:8rem;height:8rem" id="img2" >
                </div>
                <div class="up2">
                    <div class="up22">
                        <div class="fileInput2">
                          <input type="file" capture="camera" name="upfile2" id="upfile2" style="display:none" class="upfile2" onchange="document.getElementById('upfileResult2').innerHTML=this.value;"/>
                          <input class="upFileBtn2" id="upfileResult2" type="button" value="上传图片" onclick="document.getElementById('upfile2').click();" />
                        </div>
                    </div>
                    <!-- <img src="images/upload.png" style="width:40px;height:40px;"> -->
                </div>
            </div>
        </div>
        <div class="yulan">
            <div onclick="ok()"><h3>预览</h3></div>
        </div>
        <div class="shengcheng">
            <div><h3>生成</h3></div>
        </div>
    </div>
    <canvas id="newCanvas" width="640" height="1440" style="border: 1px solid #3E3E3E; width: 320px; height: 740px;margin: 152px 5px;"></canvas>
    <!-- 第一个页面结束 -->
  <script type="text/javascript">
      function ok(){
        var img1=document.getElementById("img1");
        var img2=document.getElementById("img2");
        var mg1=new Image();
        mg1.src=img1.src;
        var mgW=mg1.width;
        var mgH=mg1.height;
        var mg2=new Image();
        mg2.src=img2.src;
        var mgW2=mg2.width;
        var mgH2=mg2.height;
        console.log(mgW+","+mgH);
        var p1=document.getElementById("p1").value;
        // console.log(p1);
        var p2=document.getElementById("p2").innerHTML;
        var p3=document.getElementById("p3").innerHTML;
        var p4=document.getElementById("p4").innerHTML;
        var p5=document.getElementById("p5").innerHTML;
        var p6=document.getElementById("p6").innerHTML;
        var p7=document.getElementById("p7").innerHTML;
        var p8=document.getElementById("p8").innerHTML;
        var p9=document.getElementById("p9").innerHTML;
        var canvas = document.getElementById("newCanvas");
        var ctx = canvas.getContext('2d');

         var getPixelRatio = function(context) {
                var backingStore = context.backingStorePixelRatio ||
                    context.webkitBackingStorePixelRatio ||
                    context.mozBackingStorePixelRatio ||
                    context.msBackingStorePixelRatio ||
                    context.oBackingStorePixelRatio ||
                    context.backingStorePixelRatio || 1;
                return (window.devicePixelRatio || 1) / backingStore;
                };
                var ratio = getPixelRatio(ctx);
        // var docWidth = $("body").width();
        // var docHeight = $(document).height();
        // var bgImg = new Image();
        //   bgImg.src = 'images/bg.jpg';
        // ctx.drawImage(bgImg,0,0,640,900, 0, 0, 640, 900);
        // var headImg = new Image();
        //   headImg.src = 'images/head.jpg';
        ctx.drawImage(img1,0,0,mgW,mgH, 0, 0, 640, 900);

        ctx.fillStyle="#ffffff";  //填充的颜色
        ctx.linewidth=1;  //边框宽
        ctx.fillRect(0,900,640,600);  //填充颜色 x y坐标 宽 高

        ctx.fillStyle="#FFF100";  //填充的颜色
        ctx.strokeStyle="#FFF100";  //边框颜色
        ctx.linewidth=1;  //边框宽
        ctx.fillRect(20,800,600,200);  //填充颜色 x y坐标 宽 高
        ctx.strokeRect(20,800,600,200);  //填充边框 x y坐标 宽 高

        ctx.font="30px Verdana";//文字1
        ctx.fillStyle="#000000";
        ctx.fillText(p1,280,840);

        ctx.font="bold 60px Verdana";//文字2
        ctx.fillStyle="#000000";
        ctx.fillText(p2,110,920);

        ctx.beginPath();   //直线
        ctx.moveTo(135,940);   
        ctx.lineTo(500,940); 
        ctx.lineWidth = 1; 
        ctx.strokeStyle = '#000000';   
        ctx.stroke();  

        ctx.font="20px Verdana";//文字3
        ctx.fillStyle="#000000";
        ctx.fillText(p3,160,980);

        ctx.font="20px Verdana";//文字4
        ctx.fillStyle="#fe86a0";
        ctx.fillText(p4,290,1040);

        ctx.font="20px Verdana";//文字5
        ctx.fillStyle="#000000";
        ctx.fillText(p5,250,1070);

        ctx.font="20px Verdana";//文字6
        ctx.fillStyle="#fe86a0";
        ctx.fillText(p6,290,1100);

        ctx.font="20px Verdana";//文字7
        ctx.fillStyle="#000000";
        ctx.fillText(p7,250,1130);

        ctx.font="20px Verdana";//文字8
        ctx.fillStyle="#fe86a0";
        ctx.fillText(p8,290,1160);

        ctx.font="20px Verdana";//文字9
        ctx.fillStyle="#000000";
        ctx.fillText(p9,250,1190);

        ctx.drawImage(img2,0,0,mgW2,mgH2, 220, 1200, 200, 200);

      }
      
      function toImg(){
        var canvas = document.getElementById("newCanvas");
        document.getElementById("newImg").src = canvas.toDataURL("image/png");
        // $('#bg').hide();
        // $('#head').hide();
        // $('#drawBut').hide();
        // $('#toBut').hide();
        // $('#newCanvas').hide();
      }
    </script>
    <!-- 第二个页面结束 -->
   
    <!-- 第三个页面结束 -->
    
     <!-- 更多模板页面结束 -->
     <div class="baocun" style="display:none">
         <div class="baocunimg">
             <img src="" style="width:24.6rem">
         </div>
         <p style="width:100%;text-align:center;margin-top: 10px;">长按图片保存到手机</p>
         <div class="conshengcheng">
             <!-- <div><h3>继续生成</h3></div> -->
             <div><h3><a href="index.html">继续生成</a></h3></div>
         </div>
     </div>
     <!-- 生成后显示页面结束 -->
</body>
</html>
<script type="text/javascript">
  $("#upfile").change(function(){
              var objUrl = getObjectURL(this.files[0]) ;
                       var file = document.getElementById("upfile").files;
                  console.log(file);
                  console.log(file[0].size);
                  console.log(file[0].type);
                  console.log(file[0].name);
                  console.log("objUrl = "+objUrl) ;

              if (objUrl) {
                $(".m1 img").attr("src", objUrl) ;
               
              }
      });
         $("#upfile2").change(function(){
        var objUrl = getObjectURL(this.files[0]) ;
                 var file = document.getElementById("upfile2").files;
            console.log(file);
            console.log(file[0].size);
            console.log(file[0].type);
            console.log(file[0].name);
          console.log("objUrl = "+objUrl) ;
        if (objUrl) {
          $(".m2 img").attr("src", objUrl) ;
          
        }
      });
          
         //建立一个可存取到该file的url
      function getObjectURL(file) {
          var url = null ; 

          if (window.createObjectURL!=undefined) { // basic
            url = window.createObjectURL(file) ;
          } else if (window.URL!=undefined) { // mozilla(firefox)
            url = window.URL.createObjectURL(file) ;
          } else if (window.webkitURL!=undefined) { // webkit or chrome
            url = window.webkitURL.createObjectURL(file) ;
          }
          return url ;
        }
</script>